"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("vue"),V=require("./hook/useResize.js"),Y=require("../../utils/sum.js"),q=require("../../utils/debounce.js"),M=t.defineComponent({name:"fz-scroll",__name:"index",props:{list:{},modelValue:{type:Boolean,default:!0},waitTime:{default:0},speed:{default:800},hover:{type:Boolean,default:!0},wheel:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(E,{emit:T}){const u=E,S=T,c=t.computed({get(){return u.modelValue},set(e){S("update:modelValue",e)}}),v=t.shallowRef(),l=t.shallowRef(),m=t.shallowRef([]),a=t.ref(1),r=t.ref(0),z=t.computed(()=>Array.from({length:a.value},()=>u.list));function L(){var o;const e=[];for(const n of Array.from(((o=m.value)==null?void 0:o[0].children)??[]))e.push(n.clientHeight);return e.reduce((n,g)=>(n.push(Y.sum([n.at(-1)??0,g])),n),[0])}function d(e){if(l.value){if(typeof e=="number"||typeof e>"u"){l.value.style.transition=`transform ${e??u.speed}ms linear`;return}l.value.style.transition=e}}let i=null,s=[];function y(){i&&(clearTimeout(i),i=null)}function p(){y(),r.value>s.length-2&&l.value&&(d(0),r.value=0,l.value.style.transform="translateY(0px)"),i=setTimeout(()=>{d(),l.value&&(r.value++,l.value.style.transform=`translateY(-${s[r.value]||0}px)`)},u.waitTime)}function $(){var e;!c.value||a.value===1||(s=L(),p(),(e=l.value)==null||e.addEventListener("transitionend",p,!0))}function h(){$()}function f(){y(),d(0),l.value&&l.value.removeEventListener("transitionend",p,!0)}function k(e){l.value&&(r.value+=e,e===-1&&r.value<0&&(r.value=s.length-2),e===1&&r.value>s.length-2&&(r.value=0),l.value.style.transform=`translateY(${-1*s[r.value]||0}px)`)}function b(e){!u.hover||!u.wheel||a.value===1||(e.deltaY>0?k(1):k(-1))}function w(){r.value=0,f(),l.value&&(l.value.style.transform="translateY(0px)")}const B=q.debounce(()=>{var n;const e=v.value,o=l.value;!e||!o||(a.value=(((n=m.value[0])==null?void 0:n.clientHeight)??0)-e.clientHeight<0?1:2,t.nextTick(()=>{c.value&&a.value>1&&h(),a.value===1&&w()}))},200);function x(e){e.forEach(()=>{B()})}return t.watch(()=>u.list,()=>{a.value=1,w(),t.nextTick(()=>{B()})}),t.watch(c,e=>{if(e){h();return}f()}),V.default([v],x),t.onBeforeUnmount(()=>{f()}),(e,o)=>(t.openBlock(),t.createElementBlock("main",{ref_key:"rootRef",ref:v,class:"fz-scroll"},[t.createElementVNode("section",{ref_key:"wrapperRef",ref:l,class:"fz-scroll-list",onWheel:o[0]||(o[0]=n=>e.wheel&&e.hover&&b(n)),onMouseover:o[1]||(o[1]=n=>e.hover&&f()),onMouseleave:o[2]||(o[2]=n=>e.hover&&h())},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(z.value,(n,g)=>(t.openBlock(),t.createElementBlock("ul",{ref_for:!0,ref_key:"listRef",ref:m,key:g,class:"fz-scroll-list"},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(n,(H,R)=>(t.openBlock(),t.createElementBlock("li",{key:R,class:"fz-scroll-list"},[t.renderSlot(e.$slots,"item",{data:H,index:R})]))),128))]))),128))],544)],512))}});exports.default=M;
